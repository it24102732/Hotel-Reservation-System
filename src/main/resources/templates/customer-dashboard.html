<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Dashboard - Hotel Paradise</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        :root {
            --primary: #005f73;      /* Deep Teal */
            --secondary: #daa520;    /* Gold */
            --light: #f8f9fa;        /* Soft Off-White */
            --dark: #212529;         /* Dark Gray/Black */
            --gray: #ced4da;
            --success: #198754;
            --warning: #ffc107;
            --danger: #dc3545;
            --card-border-radius: 1rem;
            --transition: all 0.3s ease-in-out;
            --font-display: 'Playfair Display', serif;
            --font-body: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font-body);
            background-color: #f7f9fc; /* Lighter, cleaner background */
            color: var(--dark);
        }

        /* --- Navigation --- */
        .navbar {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.07);
        }

        .navbar-brand {
            font-family: var(--font-display);
            font-size: 1.75rem;
            color: var(--primary);
        }

        .nav-link {
            font-weight: 600;
            color: #555;
            transition: var(--transition);
        }

        .nav-link:hover, .nav-link.active {
            color: var(--primary);
        }

        /* --- Dashboard Header --- */
        .dashboard-header {
            color: white;
            padding: 5rem 0;
            margin-bottom: 2.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
            url('https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=2070&q=80') center/cover;
            border-radius: 0 0 50px 50px;
        }

        .dashboard-header h1 {
            font-family: var(--font-display);
            font-size: 3.5rem;
            text-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        /* --- Cards --- */
        .stat-card, .booking-card, .room-type-card, .food-card, .empty-state, .booking-filters, .price-calculator {
            background: white;
            border: 1px solid #eef2f7;
            border-radius: var(--card-border-radius);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.06);
            transition: var(--transition);
            height: 100%;
        }

        .stat-card:hover, .booking-card:hover, .room-type-card:hover, .food-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.7rem;
            margin-bottom: 1rem;
            background-color: var(--primary);
            color: white;
        }

        /* --- Section Titles --- */
        .section-title {
            font-family: var(--font-display);
            font-size: 2.5rem;
            margin-bottom: 2.5rem;
            position: relative;
            padding-bottom: 1rem;
            color: var(--primary);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 70px;
            height: 3px;
            background: var(--secondary);
            border-radius: 2px;
        }

        /* --- Buttons --- */
        .btn {
            border-radius: 0.75rem;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            transition: var(--transition);
        }

        .btn-book {
            background-color: var(--secondary);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(218, 165, 32, 0.3);
        }

        .btn-book:hover {
            background-color: #c7951d;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(218, 165, 32, 0.4);
            color: white;
        }

        .btn-outline-primary {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-outline-primary:hover {
            background: var(--primary);
            color: white;
        }

        /* --- Room Type Cards --- */
        .room-type-card {
            cursor: pointer;
            overflow: hidden;
        }

        .room-type-header {
            height: 220px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: flex-end;
            padding: 1.5rem;
            position: relative;
        }

        .room-type-header::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
        }

        .room-type-header h4 {
            position: relative;
            color: white;
            font-family: var(--font-display);
            font-size: 1.75rem;
        }

        .room-type-body {
            padding: 1.5rem;
        }

        .room-price {
            font-family: var(--font-display);
            color: var(--primary);
            font-size: 2rem;
        }

        .feature-icon {
            color: var(--secondary);
            margin-right: 0.5rem;
        }

        .single-room-bg { background-image: url('https://images.unsplash.com/photo-1631049307264-da0ec9d70304?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80'); }
        .double-room-bg { background-image: url('https://images.unsplash.com/photo-1590490360182-c33d57733427?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1074&q=80'); }
        .suite-room-bg { background-image: url('https://images.unsplash.com/photo-1590073242678-70ee3fc28e8e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1121&q=80'); }

        /* --- Booking Cards --- */
        .booking-card .booking-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eef2f7;
        }

        .booking-card .booking-body {
            padding: 1.5rem;
        }

        /* --- Status Badges --- */
        .status-badge {
            font-size: 0.8rem;
            font-weight: 700;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            text-transform: uppercase;
        }

        .status-pending { background-color: #fff8e1; color: #f57f17; }
        .status-confirmed { background-color: #e8f5e9; color: #2e7d32; }
        .status-checked-in { background-color: #e3f2fd; color: #1565c0; }
        .status-cancelled { background-color: #ffebee; color: #c62828; }
        .pending-assignment-badge { background-color: #fff8e1; color: #f57f17; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem; }


        /* --- Food Service Section --- */
        .food-card .food-icon {
            width: 70px;
            height: 70px;
            font-size: 2rem;
            margin-bottom: 1rem;
            border-radius: 1rem;
            background: rgba(0, 95, 115, 0.1);
            color: var(--primary);
        }

        /* --- Modal --- */
        .modal-content {
            border-radius: var(--card-border-radius);
            border: none;
        }

        .modal-header {
            background-color: var(--primary);
            color: white;
            border-radius: var(--card-border-radius) var(--card-border-radius) 0 0;
            padding: 1.5rem;
        }
        .modal-header .modal-title {
            font-family: var(--font-display);
            font-size: 1.75rem;
        }

        /* --- Spinner --- */
        .spinner-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .spinner-overlay.show { visibility: visible; opacity: 1; }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(0, 95, 115, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- Animations --- */
        .fade-in {
            animation: fadeIn 0.8s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Responsive Adjustments --- */
        @media (max-width: 768px) {
            .dashboard-header h1 { font-size: 2.5rem; }
            .section-title { font-size: 2rem; }
        }
    </style>
</head>
<body>

<div class="spinner-overlay" id="spinner">
    <div class="spinner"></div>
</div>

<nav class="navbar navbar-expand-lg navbar-light sticky-top animate__animated animate__fadeInDown">
    <div class="container">
        <a class="navbar-brand" th:href="@{/customer/dashboard}">
            <i class="fas fa-hotel"></i> Hotel Paradise
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link active" th:href="@{/customer/dashboard}"><i class="fas fa-home me-1"></i>Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/customer/wallet}"><i class="fas fa-wallet me-1"></i>My Wallet</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/customer/food-order/menu}"><i class="fas fa-utensils me-1"></i>Food Service</a></li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-1"></i>
                        <span th:text="${user.name}">User</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" th:href="@{/customer/profile}"><i class="fas fa-user me-2"></i>My Profile</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" th:href="@{/logout}"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<header class="dashboard-header animate__animated animate__fadeIn">
    <div class="container">
        <h1 class="display-4 fw-bold mb-3">
            Welcome back, <span th:text="${user.name}">Guest</span>!
        </h1>
        <p class="lead mb-0">Your personal gateway to a memorable stay.</p>
    </div>
</header>

<main class="container my-5">

    <div th:if="${success}" class="alert alert-success alert-dismissible fade show animate__animated animate__fadeIn" role="alert">
        <i class="fas fa-check-circle me-2"></i><span th:text="${success}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show animate__animated animate__fadeIn" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i><span th:text="${error}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <section class="row g-4 mb-5 fade-in" style="animation-delay: 0.2s;">
        <div class="col-md-3"><div class="stat-card p-4 text-center"><div class="stat-icon mx-auto"><i class="fas fa-bed"></i></div><h3 class="fw-bold mb-0" th:text="${activeBookings}">0</h3><p class="text-muted mb-0">Active Bookings</p></div></div>
        <div class="col-md-3"><div class="stat-card p-4 text-center"><div class="stat-icon mx-auto"><i class="fas fa-clock"></i></div><h3 class="fw-bold mb-0" th:text="${pendingBookings}">0</h3><p class="text-muted mb-0">Pending Payments</p></div></div>
        <div class="col-md-3"><div class="stat-card p-4 text-center"><div class="stat-icon mx-auto"><i class="fas fa-check-circle"></i></div><h3 class="fw-bold mb-0" th:text="${completedBookings}">0</h3><p class="text-muted mb-0">Completed Stays</p></div></div>
        <div class="col-md-3"><div class="stat-card p-4 text-center"><div class="stat-icon mx-auto"><i class="fas fa-wallet"></i></div><h3 class="fw-bold mb-0">$<span th:text="${#numbers.formatDecimal(totalBalance, 1, 2)}">0.00</span></h3><p class="text-muted mb-0">Wallet Balance</p></div></div>
    </section>

    <section id="roomTypes" class="mb-5 fade-in" style="animation-delay: 0.4s;">
        <h2 class="section-title">Explore Our Rooms</h2>
        <div class="row g-4">
            <div class="col-lg-4 col-md-6"><div class="room-type-card" onclick="showBookingModal('Single', 50.00)"><div class="room-type-header single-room-bg"><h4>Single Room</h4></div><div class="room-type-body"><div class="d-flex justify-content-between align-items-center mb-3"><h3 class="room-price mb-0">$50</h3><small class="text-muted fw-light">/ night</small></div><ul class="list-unstyled mb-4"><li><i class="fas fa-check feature-icon"></i>1 Single Bed</li><li><i class="fas fa-check feature-icon"></i>Free WiFi & TV</li><li><i class="fas fa-check feature-icon"></i>Perfect for solo travelers</li></ul><button class="btn btn-book w-100">Book Now</button></div></div></div>
            <div class="col-lg-4 col-md-6"><div class="room-type-card" onclick="showBookingModal('Double', 80.00)"><div class="room-type-header double-room-bg"><h4>Double Room</h4></div><div class="room-type-body"><div class="d-flex justify-content-between align-items-center mb-3"><h3 class="room-price mb-0">$80</h3><small class="text-muted fw-light">/ night</small></div><ul class="list-unstyled mb-4"><li><i class="fas fa-check feature-icon"></i>1 Double Bed</li><li><i class="fas fa-check feature-icon"></i>Free WiFi & Breakfast</li><li><i class="fas fa-check feature-icon"></i>Ideal for couples</li></ul><button class="btn btn-book w-100">Book Now</button></div></div></div>
            <div class="col-lg-4 col-md-6"><div class="room-type-card" onclick="showBookingModal('Suite', 150.00)"><div class="room-type-header suite-room-bg"><h4>Suite</h4></div><div class="room-type-body"><div class="d-flex justify-content-between align-items-center mb-3"><h3 class="room-price mb-0">$150</h3><small class="text-muted fw-light">/ night</small></div><ul class="list-unstyled mb-4"><li><i class="fas fa-check feature-icon"></i>King Size Bed</li><li><i class="fas fa-check feature-icon"></i>Separate Living Area</li><li><i class="fas fa-check feature-icon"></i>Luxury experience</li></ul><button class="btn btn-book w-100">Book Now</button></div></div></div>
        </div>
    </section>

    <section id="bookings" class="mb-5 fade-in" style="animation-delay: 0.6s;">
        <h2 class="section-title">My Bookings</h2>
        <div th:if="${#lists.isEmpty(bookings)}" class="empty-state text-center p-5"><div class="display-1 text-light"><i class="fas fa-calendar-times"></i></div><h4 class="fw-bold mt-4">No Bookings Yet</h4><p class="text-muted mb-4">Your booking journey starts here. Find your perfect room.</p><a href="#roomTypes" class="btn btn-book"><i class="fas fa-plus-circle me-2"></i>Book Your First Room</a></div>
        <div th:if="${!#lists.isEmpty(bookings)}">
            <div class="booking-filters p-4 mb-4"><div class="row g-3"><div class="col-md-4"><label class="form-label">Filter by Status</label><select class="form-select" id="statusFilter"><option value="">All Statuses</option><option value="PENDING">Pending</option><option value="CONFIRMED">Confirmed</option><option value="CHECKED_IN">Checked In</option><option value="CANCELLED">Cancelled</option></select></div><div class="col-md-4"><label class="form-label">Sort by</label><select class="form-select" id="sortBookings"><option value="date-desc">Newest First</option><option value="date-asc">Oldest First</option><option value="price-desc">Price: High to Low</option><option value="price-asc">Price: Low to High</option></select></div><div class="col-md-4"><label class="form-label">Search</label><input type="text" class="form-control" id="searchBookings" placeholder="Search by room type..."></div></div></div>
            <div class="row g-4" id="bookingsList">
                <div class="col-md-6 booking-item" th:each="booking : ${bookings}" th:data-status="${booking.status}" th:data-price="${booking.totalPrice}" th:data-date="${booking.checkInDate}">
                    <div class="booking-card"><div class="booking-header d-flex justify-content-between align-items-center"><div><h5 class="fw-bold mb-0"><span th:if="${booking.room != null}" th:text="${booking.room.type}">Room</span><span th:if="${booking.room == null}" th:text="${booking.roomType}">Room</span></h5><small class="text-muted" th:if="${booking.room != null}">Room #<span th:text="${booking.room.roomNumber}"></span></small><small th:if="${booking.room == null}" class="pending-assignment-badge"><i class="fas fa-clock me-1"></i>Pending Assignment</small></div><span class="status-badge" th:classappend="${'status-' + #strings.toLowerCase(#strings.replace(booking.status, '_', '-'))}" th:text="${booking.status}"></span></div><div class="booking-body"><div class="row mb-3"><div class="col-6"><small class="text-muted d-block">Check-in</small><strong><span th:text="${#temporals.format(booking.checkInDate, 'MMM dd, yyyy')}"></span></strong></div><div class="col-6"><small class="text-muted d-block">Check-out</small><strong><span th:text="${#temporals.format(booking.checkOutDate, 'MMM dd, yyyy')}"></span></strong></div></div><div class="mb-3"><small class="text-muted d-block">Total</small><h4 class="fw-bold text-primary mb-0">$<span th:text="${#numbers.formatDecimal(booking.totalPrice, 1, 2)}"></span></h4></div><div class="d-flex gap-2"><a th:href="@{/customer/bookings/{id}(id=${booking.id})}" class="btn btn-outline-primary btn-sm flex-fill"><i class="fas fa-eye me-1"></i>Details</a><a th:if="${booking.status == 'PENDING'}" th:href="@{/customer/payment/booking/{id}(id=${booking.id})}" class="btn btn-success btn-sm flex-fill"><i class="fas fa-credit-card me-1"></i>Pay Now</a><form th:if="${booking.status == 'PENDING' || booking.status == 'CONFIRMED'}" th:action="@{/customer/booking/cancel/{id}(id=${booking.id})}" method="post" class="flex-fill"><button type="submit" class="btn btn-outline-danger btn-sm w-100" onclick="return confirmCancellation(event)"><i class="fas fa-times me-1"></i>Cancel</button></form></div></div></div>
                </div>
            </div>
        </div>
    </section>

    <section class="food-service-section fade-in" style="animation-delay: 0.8s;">
        <h2 class="section-title">Dining & Room Service</h2>
        <div class="row g-4">
            <div class="col-md-4"><div class="food-card text-center p-4" onclick="window.location.href='/customer/food-order/menu'"><div class="food-icon mx-auto"><i class="fas fa-utensils"></i></div><h5 class="fw-bold mb-2">Browse Menu</h5><p class="text-muted">Explore delicious meals from our kitchen.</p></div></div>
            <div class="col-md-4"><div class="food-card text-center p-4" onclick="window.location.href='/customer/food-order/history'"><div class="food-icon mx-auto"><i class="fas fa-history"></i></div><h5 class="fw-bold mb-2">Order History</h5><p class="text-muted">Review your past food and beverage orders.</p></div></div>
            <div class="col-md-4"><div class="food-card text-center p-4" onclick="window.location.href='/customer/food-order/menu'"><div class="food-icon mx-auto"><i class="fas fa-concierge-bell"></i></div><h5 class="fw-bold mb-2">Room Service</h5><p class="text-muted">Enjoy fine dining in the comfort of your room.</p></div></div>
        </div>
    </section>

</main>

<div class="modal fade" id="bookingModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header"><h5 class="modal-title" id="modalTitle"><i class="fas fa-calendar-plus me-2"></i>Book Your Stay</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
            <div class="modal-body p-4">
                <form id="bookingForm" th:action="@{/customer/book-room-type}" method="post">
                    <input type="hidden" id="roomType" name="roomType">
                    <h4 id="selectedRoomType" class="text-primary fw-bold"></h4>
                    <p class="text-muted mb-4"><i class="fas fa-dollar-sign me-1"></i><span id="displayPrice"></span> / night</p>
                    <div class="row g-3 mb-3">
                        <div class="col-md-6"><label for="checkInDate" class="form-label fw-semibold">Check-in Date</label><input type="text" class="form-control" id="checkInDate" name="checkInDate" required placeholder="Select date"></div>
                        <div class="col-md-6"><label for="checkOutDate" class="form-label fw-semibold">Check-out Date</label><input type="text" class="form-control" id="checkOutDate" name="checkOutDate" required placeholder="Select date"></div>
                    </div>
                    <div class="mb-4"><label for="specialRequests" class="form-label fw-semibold">Special Requests</label><textarea class="form-control" id="specialRequests" name="specialRequests" rows="3" placeholder="e.g., late check-in, high floor..."></textarea></div>
                    <div class="price-calculator p-4 mb-4">
                        <h5 class="mb-3 fw-bold">Price Summary</h5>
                        <div class="d-flex justify-content-between mb-2"><span>Room rate:</span><span id="roomRate">$0.00</span></div>
                        <div class="d-flex justify-content-between mb-2"><span>Nights:</span><span id="nightCount">0</span></div>
                        <div class="d-flex justify-content-between mb-2"><span>Taxes & fees (10%):</span><span id="taxAmount">$0.00</span></div><hr>
                        <div class="d-flex justify-content-between fw-bold h5"><span>Estimated Total:</span><span id="totalAmount" class="text-primary">$0.00</span></div>
                    </div>
                    <div class="alert alert-info d-flex align-items-start"><i class="fas fa-info-circle me-2 mt-1"></i><small>Payment is required to confirm your booking. A room will be assigned by our staff upon confirmation.</small></div>
                    <div class="modal-footer border-0 p-0 pt-3"><button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button><button type="submit" class="btn btn-book">Continue to Payment</button></div>
                </form>
            </div>
        </div>
    </div>
</div>

<footer class="py-4 mt-5 bg-white border-top">
    <div class="container text-center">
        <p class="mb-0 text-muted">&copy; 2025 Hotel Paradise. All Rights Reserved.</p>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Flatpickr initialization
        const checkInPicker = flatpickr("#checkInDate", {
            minDate: "today",
            dateFormat: "Y-m-d",
            onChange: function(selectedDates, dateStr) {
                if (selectedDates.length > 0) {
                    const nextDay = new Date(selectedDates[0]);
                    nextDay.setDate(nextDay.getDate() + 1);
                    checkOutPicker.set("minDate", nextDay);
                    if (checkOutPicker.selectedDates.length > 0 && checkOutPicker.selectedDates[0] <= selectedDates[0]) {
                        checkOutPicker.setDate(nextDay, true);
                    }
                }
                calculateTotal();
            }
        });

        const checkOutPicker = flatpickr("#checkOutDate", {
            minDate: new Date().fp_incr(1),
            dateFormat: "Y-m-d",
            onChange: calculateTotal
        });

        // Show spinner on form submission
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', () => document.getElementById('spinner').classList.add('show'));
        });

        // Booking filter/sort logic
        const bookingsList = document.getElementById('bookingsList');
        if (bookingsList) {
            const statusFilterEl = document.getElementById('statusFilter');
            const sortBookingsEl = document.getElementById('sortBookings');
            const searchBookingsEl = document.getElementById('searchBookings');

            const applyFilters = () => {
                const statusFilter = statusFilterEl.value;
                const sortOption = sortBookingsEl.value;
                const searchQuery = searchBookingsEl.value.toLowerCase();
                let items = Array.from(bookingsList.querySelectorAll('.booking-item'));

                // Filter
                items.forEach(item => {
                    const status = item.dataset.status;
                    const content = item.textContent.toLowerCase();
                    const statusMatch = !statusFilter || status === statusFilter;
                    const searchMatch = !searchQuery || content.includes(searchQuery);
                    item.style.display = (statusMatch && searchMatch) ? '' : 'none';
                });

                // Sort
                let visibleItems = items.filter(item => item.style.display !== 'none');
                visibleItems.sort((a, b) => {
                    const dateA = new Date(a.dataset.date);
                    const dateB = new Date(b.dataset.date);
                    const priceA = parseFloat(a.dataset.price);
                    const priceB = parseFloat(b.dataset.price);

                    switch (sortOption) {
                        case 'date-desc': return dateB - dateA;
                        case 'date-asc': return dateA - dateB;
                        case 'price-desc': return priceB - priceA;
                        case 'price-asc': return priceA - priceB;
                        default: return 0;
                    }
                });

                // Re-append to DOM
                visibleItems.forEach(item => bookingsList.appendChild(item));
            };

            statusFilterEl.addEventListener('change', applyFilters);
            sortBookingsEl.addEventListener('change', applyFilters);
            searchBookingsEl.addEventListener('input', applyFilters);
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    });

    function calculateTotal() {
        const roomType = document.getElementById('roomType').value;
        const checkInDate = document.getElementById('checkInDate').value;
        const checkOutDate = document.getElementById('checkOutDate').value;
        if (!checkInDate || !checkOutDate) return;

        const priceMap = { 'Single': 50.00, 'Double': 80.00, 'Suite': 150.00 };
        const price = priceMap[roomType] || 0;
        const nights = Math.ceil((new Date(checkOutDate) - new Date(checkInDate)) / (1000 * 60 * 60 * 24));

        if (nights > 0) {
            const subtotal = price * nights;
            const taxes = subtotal * 0.10;
            const total = subtotal + taxes;
            document.getElementById('roomRate').textContent = '$' + price.toFixed(2);
            document.getElementById('nightCount').textContent = nights;
            document.getElementById('taxAmount').textContent = '$' + taxes.toFixed(2);
            document.getElementById('totalAmount').textContent = '$' + total.toFixed(2);
        } else {
            document.getElementById('nightCount').textContent = 0;
            document.getElementById('taxAmount').textContent = '$0.00';
            document.getElementById('totalAmount').textContent = '$0.00';
        }
    }

    function showBookingModal(roomType, price) {
        document.getElementById('roomType').value = roomType;
        document.getElementById('selectedRoomType').textContent = roomType + ' Room';
        document.getElementById('displayPrice').textContent = '$' + price.toFixed(2);
        document.getElementById('roomRate').textContent = '$' + price.toFixed(2);
        calculateTotal();
        const modal = new bootstrap.Modal(document.getElementById('bookingModal'));
        modal.show();
    }

    function confirmCancellation(event) {
        if (!confirm('Are you sure you want to cancel this booking? This action cannot be undone.')) {
            event.preventDefault();
            return false;
        }
        document.getElementById('spinner').classList.add('show');
        return true;
    }
</script>

</body>
</html>